"use strict";angular.module("app",["ngResource","angular-jwt","angular-storage","ui.router","ngAnimate"]).config(["$interpolateProvider","$locationProvider","$urlRouterProvider","$resourceProvider","$httpProvider","$stateProvider","jwtInterceptorProvider",function(e,t,r,n,i,s,o){n.defaults.stripTrailingSlashes=!1,e.startSymbol("[["),e.endSymbol("]]"),i.defaults.xsrfCookieName="csrftoken",i.defaults.xsrfHeaderName="X-CSRFToken",o.tokenGetter=["store",function(e){return e.get("jwt")}],i.interceptors.push("jwtInterceptor"),t.html5Mode(!0),r.otherwise("/"),s.state("home",{url:"/",templateUrl:"/static/partials/home.html"}).state("reminders",{url:"/reminders",controller:"reminder",templateUrl:"/static/partials/reminders.html"}).state("addReminder",{url:"/reminders/add",controller:"compose",templateUrl:"/static/partials/compose.html"}).state("editReminder",{url:"/reminders/:reminderId/edit",controller:"compose",templateUrl:"/static/partials/compose.html"}).state("register",{url:"/register",controller:"registration",templateUrl:"/static/partials/register.html"}).state("login",{url:"/login",controller:"login",templateUrl:"/static/partials/login.html"}).state("forgotPassword",{url:"/password/forgot",controller:"password",templateUrl:"/static/partials/forgotpass.html"}).state("resetPassword",{url:"/password/reset/confirm/:uid/:token",controller:"password",templateUrl:"/static/partials/resetpass.html"})}]).run(["AuthService","$rootScope","$state","$location",function(e,t,r,n){function i(e,t){for(var r=0;r<t.length;r++)if(e===t[r])return!0;return!1}e.fillAuthData();var s=new Array("/reminders","/settings","/logout");t.$on("$stateChangeStart",function(t,r,o){e.authentication().isAuthenticated||i(r.url,s)&&n.path("/login")})}]).factory("Reminder",["$resource",function(e){return e("/api/reminders/:id/",null,{update:{method:"PUT"}})}]).service("ReminderService",["$resource","Reminder",function(e,t){var r=this;return r.reminders=[],r.setReminders=function(){r.reminders=t.query()},r.addReminder=function(e){return t.save(e,function(e){r.reminders.push(e),toastr.success("Successfully created reminder!")})},r.updateReminder=function(e){return t.update({id:e.id},e,function(){angular.extend(_.find(r.reminders,{id:e.id}),e),toastr.success("Successfully saved reminder!")})},r.deleteReminder=function(e){t["delete"](e,function(){_.remove(r.reminders,e)})},r.getReminder=function(e){return t.get({id:e})},r.teardown=function(){r.reminders=null},r.init=function(){r.setReminders()},r}]);
!function(){"use strict";function e(e,t,i,r,n){function a(e){return e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function m(){e.btnValue="Update",e.isEditing=!0,i.getReminder(n.reminderId).$promise.then(function(t){e.reminder=t,e.reminder.remind_date=new Date(t.remind_date);var i=e.reminder.remind_date.getHours();i>11?(e.time.ampm="PM",13>i?e.time.hours=0:e.time.hours=i-12):(e.time.ampm="AM",e.time.hours=i),console.log(e.time.hours)})}function o(){e.btnValue="Create",e.isEditing=!1,e.reminder={title:"",notes:"",remind_date:""}}e.reminder={priority:"L",remind_date:a(new Date)},e.time={hours:0,ampm:"AM"},e.times=[{val:1,text:"1:00"},{val:2,text:"2:00"},{val:3,text:"3:00"},{val:4,text:"4:00"},{val:5,text:"5:00"},{val:6,text:"6:00"},{val:7,text:"7:00"},{val:8,text:"8:00"},{val:9,text:"9:00"},{val:10,text:"10:00"},{val:11,text:"11:00"},{val:0,text:"12:00"}],e.$watchGroup(["time.hours","time.ampm"],function(){var t,i=e.time.hours,r=e.time.ampm;t="PM"==r?12==i?i:i+12:i,e.reminder.remind_date.setHours(t)}),e.btnValue="Create",e.isEditing=!1,e.priorityOptions=[{val:"L",text:"Low"},{val:"M",text:"Medium"},{val:"H",text:"High"}],r.includes("editReminder")&&m(),e.saveReminder=function(e,t,n){n&&(t?i.updateReminder(e).$promise.then(function(e){o(),r.go("reminders")})["catch"](function(e){toastr.error("Could not save reminder.")}):i.addReminder(e).$promise.then(function(e){o(),r.go("reminders")})["catch"](function(e){toastr.error("Could not create reminder.")}))}}angular.module("app").controller("compose",e),e.$inject=["$scope","Reminder","ReminderService","$state","$stateParams"]}();
!function(){"use strict";function t(t){t.open=function(e){e.preventDefault(),e.stopPropagation(),t.opened=!0},t.dateOptions={formatYear:"yy",startingDay:1},t.format="dd-MMMM-yyyy";var e=new Date;e.setDate(e.getDate()+1);var a=new Date;a.setDate(e.getDate()+2),t.events=[{date:e,status:"full"},{date:a,status:"partially"}],t.getDayClass=function(e,a){if("day"===a)for(var n=new Date(e).setHours(0,0,0,0),s=0;s<t.events.length;s++){var r=new Date(t.events[s].date).setHours(0,0,0,0);if(n===r)return t.events[s].status}return""}}angular.module("app").controller("datepicker",t),t.$inject=["$scope"]}();
!function(){"use strict";function t(t,n,e,o){t.user={},t.login=function(){n({url:"/api-token-auth/",method:"POST",data:t.user}).then(function(t){e.login(t.data.token),o.go("reminders")},function(t){alert(t.data)})}}angular.module("app").controller("login",t),t.$inject=["$scope","$http","AuthService","$state"]}();
!function(){"use strict";function t(t,n,u){function e(){n.menuActive=!n.menuActive}n.menuActive=!1,n.toggleMenu=e,n.auth=t.authentication(),n.logout=function(){t.logout(),u.go("login"),e()},n.$watch(function(){return t.authentication()},function(u){n.auth=t.authentication()})}angular.module("app").controller("main",t),t.$inject=["AuthService","$scope","$state"]}();
!function(){"use strict";function o(o,t,e,n){function s(){t.post("/auth/password/reset/",o.requestChange).then(function(o){toastr.info("Check your email for a link to reset password."),e.go("login")},function(o){toastr.error("Invalid Email. Try Again.")})}function r(){t.post("/auth/password/reset/confirm/",o.changeInfo).then(function(o){toastr.success("Password reset! You may now log in."),e.go("login")},function(o){toastr.error("A problem occured not reset password."),console.log(o)})}function a(t,e){o.changeInfo.uid=t,o.changeInfo.token=e}var i=n.uid,c=n.token;o.requestResetEmail=s,o.resetPassword=r,o.requestChange={email:""},o.changeInfo={},a(i,c)}angular.module("app").controller("password",o),o.$inject=["$scope","$http","$state","$stateParams"]}();
!function(){"use strict";function n(n,o,t){o.regInfo={},o.register=function(o){o.skipAuthorization=!0,n.post("/auth/register/",o).success(function(){toastr.success("Thanks for signing up for rmnd.in"),t.go("login")}).error(function(n){console.log(n)})}}angular.module("app").controller("registration",n),n.$inject=["$http","$scope","$state"]}();
!function(){"use strict";function e(e,t,r,n){function i(e){l=e==l?null:e}function o(){return l}function c(e){var t=(new Date).getTime(),r=new Date(e.remind_date).getTime();return e.on_hold?"fa fa-pause fa-pink":r>t?"fa fa-clock-o fa-blue":"fa fa-check fa-green"}var l=null;e.setMenuActive=i,e.getMenuActive=o,e.getStatusClass=c,e.sortType=["-complete","created_at"],e.sortReverse=!0,e.filter,e.filterStr="all",e.getPriority=function(e){switch(e.priority){case"L":return"Low";case"M":return"Medium";case"H":return"High";default:return"Low"}},e.setFilter=function(t){"upcoming"==t?(e.filter={complete:!1},e.filterStr="upcoming",e.sortType="-remind_date"):"sent"==t?(e.filter={complete:!0},e.filterStr="sent"):(e.filter="",e.filterStr="all",e.sortType=["-complete","created_at"])},e.isActiveFilter=function(t){return t==e.filterStr?!0:!1},e.toggleReverse=function(){e.sortReverse=!e.sortReverse},e.setSortType=function(t){e.sortType=t},e.getDirectionClass=function(){return e.sortReverse===!0?"glyphicon-arrow-up":"glyphicon-arrow-down"},e.reminders=n.reminders,e["delete"]=function(e){n.deleteReminder(e)}}angular.module("app").controller("reminder",e),e.$inject=["$scope","$interval","Reminder","ReminderService"]}();
!function(){function e(e){return{restrict:"A",require:"ngModel",link:function(n,t,r,i){i.$parsers.push(function(e){return e}),i.$formatters.push(function(n){return e("date")(n,"MM/dd/yyyy")}),$(function(){t.datepicker({onSelect:function(e){i.$setViewValue(new Date(e)),n.$apply()}})})}}}angular.module("app").directive("datePicker",e),e.$inject=["$filter"]}();
!function(){function t(t){function e(t){t=new Date(t);var e,a=86400,n=3600,r=60,o=(new Date).getTime(),f=t.getTime(),i=Math.floor((f-o)/1e3),u=Math.floor(i/a);e=i%a;var h=Math.floor(e/n);e%=n;var l=Math.floor(e/r);e%=r;return u>0?1===u?"1d "+h+"h":u+"d "+h+"h":h>0?1===h?"1h "+l+"m":h+"h "+l+"m":l>0?1===l?"1m":l+"m":0===l?"< 1m":"Past"}return t(function(){},1e3),e.$stateful=!0,e}angular.module("app").filter("humanize",t),t.$inject=["$interval"]}();
function authService(e,t,n,a){function i(t){e({url:"/api-token-refresh/",method:"POST",data:{token:t}}).then(function(e){n.set("jwt",e.data.token)})}var r={},u={username:"",isAuthenticated:!1},o=function(e){a.teardown();var i=t.decodeToken(e);u.username=i.username,u.isAuthenticated=!0,n.set("jwt",e),a.init()},c=function(){u.username="",u.isAuthenticated=!1,a.teardown(),n.remove("jwt")},s=function(){var e=localStorage.getItem("jwt");if(e){var n=t.isTokenExpired(e);if(n)u.isAuthenticated=!1,u.username="";else{i(JSON.parse(e));var a=t.decodeToken(e);u.isAuthenticated=!0,u.username=a.username}}},d=function(){return u};return r.login=o,r.logout=c,r.fillAuthData=s,r.authentication=d,r}angular.module("app").factory("AuthService",authService),authService.$inject=["$http","jwtHelper","store","ReminderService"];